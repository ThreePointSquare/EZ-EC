<!DOCTYPE html>
<html lang="en">
	<head>
		<title>three.js webgl - loaders - Rhino 3DM loader</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<link type="text/css" rel="stylesheet" href="main.css">

		<style>
			html, body {
  margin: 0;
  height: 100%;
  overflow: hidden;
	color:black;
}

body{
  display: flex;
	font-family: Arial, Helvetica, sans-serif;
  /* flex-direction: column; */
  background-color: #ffffff;
}

#c, #d, #e {
  display: flex;

  width: 100%;
  /* height: 75%; */
	/* width: 100%; */
	height: 75vh;
  /* margin: auto; */
	/* margin-top: 9% */
  /* margin-bottom: 3%; */

  /* border-radius: 3px; */
  /* box-shadow:  10px 10px 12px -4px rgba(0,0,0,0.35); */
}

#app {
  display: flex;
	/* float: right ; */


  /* width: 30%; */
  /* height: 15%; */
  margin: auto;
	/* margin-top: 9% */
	margin-top:8vh;
  /* margin-bottom: 3%; */

  /* border-radius: 3px; */
  /* box-shadow:  10px 10px 12px -4px rgba(0,0,0,0.35); */
}

td{
	text-align: center;
	padding: 3px 10px 3px 10px;
}

/* #globalDisplacement {
  width: 50%;
} */

/* #screenshot {
  width: 50px;
  height: 50px;
  border-radius: 25px;
  background-color:#1e88e5;
  color:white;
  box-shadow: 3px 3px 20px 0px rgba(0,0,0,0.5); 
  border:none;
  cursor: pointer;

  display: flex;

  transition: background-color 200ms ease-in-out, box-shadow 200ms ease-in-out;
}

#screenshot:hover {
  background-color:#64b5f6;
  box-shadow: 3px 3px 10px 0px rgba(0,0,0,0.75); 
} */

/* #controls {
  margin: auto;
  width: 75%;
  margin-top: 0px;
  display: flex;
  justify-content: space-around;
} */

canvas:focus, input:focus, button:focus{
  outline: none;
}

.tabs {
	display: flex;
	flex-wrap: wrap; 
	max-height: 10px;
	width: 65%;
	margin: 5px;
	/* border: 1px solid black; */
}
.tabs label {
	z-index: 100;
	order: 1;
	display: block;
	padding: 1rem 2rem;
	margin-right: 0.2rem;
	cursor: pointer;
  background: #eee;
	color: #333;
  
	border: 1px solid black;
	border-bottom: white;
	border-collapse: collapse;
  /* transition: background ease 0.2s; */
	border-radius: 5px 5px 0px 0px;
}
.tabs .tab {
  order: 99;
  /* flex-grow: 1; */
	width: 100%;
	border: 1px solid black;
	/* border-top: none; */
	border-collapse: collapse;
	/* height: 95%; */
	
	display: none;
  /* padding: 1rem; */
  background: #fff;
}
.tabs input[type="radio"] {
	display: none;
	/* max-height: 10px; */
}
.tabs input[type="radio"]:checked + label {
	background: #fff;
	font-weight: bold;
	color:black;
	
	margin-bottom: -1px;
	/* height: 20px; */
}
.tabs input[type="radio"]:checked + label + .tab {
	display: block;
	
}

/* @media (max-width: 45em) {
  .tabs .tab,
  .tabs label {
    order: initial;
  }
  .tabs label {
    width: 100%;
    margin-right: 0;
    margin-top: 0.2rem;
  }
} */

/**
 * Generic Styling
*/
body {
  /* background: #eee; */
  min-height: 200vh;
	/* box-sizing: border-box; */
	padding-top: 15vh;
  /* font-family: "HelveticaNeue-Light", "Helvetica Neue Light", "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif;  */
  font-weight: 300;
  line-height: 1.5;
  /* max-width: 60rem; */
  /* margin: 0 auto; */
  /* font-size: 112%; */
}

path {
  /* fill: #ccc; */
  stroke-width: none;
  transition: fill 250ms linear;
  transition-delay: 150ms;
}

path:hover {
  /* fill: #999; */
  stroke: #000;
  transition-delay: 0;
}

.nav-bar {
	position: absolute;
	display: block;
  background: linear-gradient(-90deg, #84CF6A, #16C0B0);
  height: 80px;
  /* margin-bottom: 15px; */
	top:0;
	left:0;
	padding: 0;
	margin: 0;
	width: 100%;
}



		</style>
	</head>

	<body>
	
			
		<div id="info">
			<div class="nav-bar">
				<h1 style="color:white; font-size: 60px; top:30px; margin-top: 25px; line-height: .5em;">EZ-EC</h1>
			</div>
			
			<h2 style="color:#333; font-size: 20px; margin-top:80px;">Embodied Carbon made Eazy</h2>
			<button id="myBtn">Design Opt 1</button>
<button id="myBtn2"> Design Opt 2</button>
<button id="myBtn3">Design Opt 3</button> 

			<!-- <div id="app"> -->
  
  <div class="product">


    <!-- <div class="product-info">
      <h1>{{ product }}</h1>
      <p v-if="inStock">In Stock</p>
      <p v-else>Out of Stock</p>

      <ul>
        <li v-for="detail in details">{{ detail }}</li>
      </ul>

      <ul>
        <li v-for="size in sizes">{{ size }}</li>
      </ul>


      <div v-for="variant in variants" :key="variant.variantId">
        <p>{{ variant.variantColor }}</p>
      </div>

    </div>   -->
    
  <!-- </div> -->
  
</div> 

			
			 <script src="https://cdn.jsdelivr.net/npm/vue@2.5.13/dist/vue.js"></script>
			 <!-- <script src="//d3js.org/d3.v3.min.js"></script> -->
			 <script src="https://d3js.org/d3.v4.min.js"></script>
			 <script src="https://unpkg.com/jeezy/lib/jeezy.min.js"></script>
			 <script>
				 let allLayers = [];

				 let myGWPMaterials = [
		{"material": "Granite",
		"value":	18.28514101
},{
	"material": "Limestone",
	"value":11.54573152
},{
	"material": "Brick",
	"value":8.629073875
},{
	"material": "InsMetalPanel",
	"value":9.171245913
},{
	"material": "Spandrel",
	"value":15.90686277
},{
	"material": "UHPC",
	"value":15.19133007
},{
	"material": "GFRC",
	"value":14.88696287
},{
	"material": "ACM",
	"value":11.07734591
},{
	"material": "Terracotta",
	"value":8.107280922
},{
	"material": "PhenResin",
	"value":8.364346902
},{
	"material": "FiberCement",
	"value":8.046661497
},{
	"material": "Zinc",
	"value":6.813886863
},{
	"material": "Granite1",
	"value":6.532641113
},{
	"material": "Limestone1",
	"value":8.107280922
},{
	"material": "Steel",
	"value":4.78009599
},{
	"material": "Wood",
	"value":5.322936027
},{
	"material": "GlazTA",
	"value":5.481279
},{
	"material": "GlazTT",
	"value":8.723595
},{
	"material": "GlazDA",
	"value":3.67896
},{
	"material": "GlazDT",
	"value":5.044635
},{
	"material": "Mull",
	"value":17.577
},{
	"material": "Slab",
	"value":15
},{
	"material": "Struct",
	"value":26
}	
	];

	let data = [];
	let prev = 0;
	let next = 0;
				function getData(){
					// next++;
			
			console.log("changing")
			
			for(let i = 0; i < allLayers.length; i++){
				let cur = allLayers[i].variantId;
			
			
			
			// let currentPos = document.getElementById(cur);
			let currentSelect = document.getElementById(cur);
			// console.log(mySel)
			let theCurrentMat = (currentSelect.options[ currentSelect.selectedIndex ].value);
			for(let j = 0; j < myGWPMaterials.length; j++){
				// console.log(e)
				if(myGWPMaterials[j].material == theCurrentMat){
					let myMult = myGWPMaterials[j].value
					let num = parseInt(allLayers[i].variantArea)
					console.log(myMult*num)
					allLayers[i].variantGWP = (num * myMult).toFixed(2);
					
				}
			}
			}
			
			}

			let currentContainer = 'c';

			function ChangetoC(){
				currentContainer = 'c';

				init();
			}

			function ChangetoD(){
				currentContainer = 'd';

				init();
			}

			function ChangetoE(){
				currentContainer = 'e';

				init();
			}
			
			
				</script>

		</div>

		<div class="tabs">
			<input type="radio" name="tabs" id="tabone" checked="checked">
			<label for="tabone">Building Viewer</label>
			<div class="tab">
				<canvas id="c"></canvas>	
			</div>
			
			<input type="radio" name="tabs" id="tabtwo">
			<label for="tabtwo">Building Designer</label>
			<div class="tab">
				<iframe src="https://dev-swarm.herokuapp.com/viewer/5f8c6016783c4a000488d0f8" width="100%" height="600px"></iframe>
			</div>

			<!-- <input type="radio" name="tabs" id="myBtn">
			<label for="tabthree">Building Designer</label> -->
			<!-- <button id="myBtn">Try it</button>
			-->
			
		</div>
		
		

		<!-- <canvas id="c"></canvas> -->


		
		
	
	 
		
		<!-- <table> -->
			<!-- <tr> -->
				<!-- <td colspan="4"> -->
				
<!-- </td>
			</tr>
		</table> -->
			<table id="app">
				
			<tr style="	font-weight: bold;;">
				<td style="width:5px"></td>
				<td>Layer Name</td>
				<td>Assembly Type</td>
				<td>Area</td>
			</tr>
			<tr v-for="variant in variants" 
			:key="variant.variantId"
			>
				<td style="width:1px" :style="{ backgroundColor: variant.variantColor }"></td>
				<td>{{ variant.variantId}}</td>
				<td>
				<select v-bind:id="variant.variantId" name="mat" onChange="getData()">
          <option value="Granite">MV - Granite</option>
            <option value="Limestone">MV - Limestone</option>
            <option value="Brick">MV - Brick</option>
            <option value="InsMetPanel">FS - Metal Panel</option>
            <option value="Spandrel">CW - Spandrel</option>
            <option value="UHPC">RS - UHPC (fibreC)</option>
            <option value="GFRC">RS - GFRC</option>
            <option value="ACM">RS - ACM</option>
            <option value="Terracotta">RS - Terracotta</option>
            <option value="PhenResin">RS - Phenolic Resin</option>
            <option value="FiberCement">RS - Fiber Cement</option>
            <option value="Zinc">RS - Zinc Panel</option>
            <option value="Granite1">RS - Granite</option>
            <option value="Limestone1">RS - Limestone</option>
            <option value="Steel">RS - Steel Panel</option>
						<option value="Wood">RS - Wood</option>
						<option value="GlazTA">Glass - Triple Pane</option>
						<option value="GlazTT">Glass - Triple Pane Tempered</option>
						<option value="GlazDA">Glass - Double Pane</option>
						<option value="GlazTT">Glass - Double Pane Tempered</option>
						<option value="Mull">Mullion - Aluminum</option>
						<option value="Slab">Slab - Concrete 10" 5ksi</option>
						<option value="Struct">Steel - Structure</option>
					</select>
				</td>
				<td>
					{{variant.variantArea}} ft<sup>2</sup>
				</td>
			</tr>

			<tr style="height: 50px;">

				<td colspan="4">
				<!-- <button>UPLOAD RHINO MODEL</button> -->
				Total GWP: <strong>{{ sum }}</strong> kgCO<sub>2</sub>eq
				</td>
			</tr>
			
			<tr style="height: 300px;">

				<td colspan="4" >
					<span id="vizz" style="position: relative;width:100%;height:300px">

					</span>
					<!-- <img src="models/3dm/Pie.png" width="90%"> -->
				</td>
			</tr>
			<tr >
				<td colspan="4">
							
				</td>
			</tr>
			<tr style="height: 100px;">

				<td colspan="4">
				<!-- <button>UPLOAD RHINO MODEL</button> -->
				<input type="file" id="file-selector" accept=".3dm">
				</td>
			</tr>
		</table>

		

<!-- <p><strong>Note:</strong> The addEventListener() method is not supported in Internet Explorer 8 and earlier versions.</p>

<p id="demo"></p> -->



	

		

		<script type="module">

		



			import * as THREE from '../build/three.module.js';

			import { OrbitControls } from './jsm/controls/OrbitControls.js';
			import { Rhino3dmLoader } from './jsm/loaders/3DMLoader.js';

			import { GUI } from './jsm/libs/dat.gui.module.js';

			let container, controls;
			let camera, scene, renderer;
			let gui;
			
			let allColors = [];
			let allLayerAreas = [];

			// let currentContainer = 'c';

			init();
			animate();

			function init() {

				THREE.Object3D.DefaultUp = new THREE.Vector3( 0, 0, 1 );
				// container = document.createElement( 'div' );
				// container = document.querySelector('#c');
				container = document.getElementById( currentContainer );
				// document.body.appendChild( container );

				// renderer = new THREE.WebGLRenderer( { canvas: container, antialias: true } );

				// aspect = canvas.clientWidth / canvas.clientHeight;

				camera = new THREE.PerspectiveCamera( 30, container.clientWidth / container.clientHeight, 1, 1000 );
				camera.position.set( -280, - 280, 310);

				camera.layers.enable( 0 ); // enabled by default
				camera.layers.enable( 1 );
				// camera.layers.enable( 2 );

				
				

				scene = new THREE.Scene();

				scene.background = new THREE.Color( 0xffffff );

				const directionalLight = new THREE.DirectionalLight( 0xffffff );
				directionalLight.position.set( .2, 10, 2 );
				directionalLight.castShadow = true;
				directionalLight.intensity = 0.4;
				scene.add( directionalLight );

				const directionalLight2 = new THREE.DirectionalLight( 0xffffff );
				directionalLight2.position.set( -10, -.2, 2 );
				directionalLight2.castShadow = true;
				directionalLight2.intensity = 0.3;
				scene.add( directionalLight2 );


				let hemiLight = new THREE.HemisphereLight( 0xffffff, 0x080808, 1 );
    hemiLight.position.set( 0, 0, 400 );
		scene.add( hemiLight );
		
		scene.add( new THREE.AmbientLight( 0xffffff, 0.2 ) );

				// sceneBox = new THREE.Box3();

				const loader = new Rhino3dmLoader();
				loader.setLibraryPath( 'jsm/libs/rhino3dm/' );

				loader.load( 'models/3dm/RhinoTemplate6.3dm', function ( object ) {
					// sceneBox.setFromObject(object);
    // let boxHelper = new THREE.Box3Helper(sceneBox, 0x0000ff);
    // scene.add(boxHelper);
    // Name to identify rhino object node
    object.name = 'rhinoDoc';
					object.children.map(child => {
      // Access attributes from the Rhino document
			let col = child.userData.attributes.drawColor;
			// console.log(child.userData.attributes.drawColor)
      let color = new THREE.Color(col.r/255, col.g/255, col.b/255);
      let mat = new THREE.MeshLambertMaterial( {
        color: color,
      } );
        // Set mesh material
				child.material = mat;
				child.layers.set(1)
		});
		object.traverse( function( obj) {
					obj.layers.set(1);
			} );
					object.layers.set(1);
					scene.add( object );
					// initGUI( object.userData.layers );
				
					initGUI( object.userData.layers );
				} );

				loader.load( 'models/3dm/RhinoTemplate7.3dm', function ( object ) {
					// sceneBox.setFromObject(object);
    // let boxHelper = new THREE.Box3Helper(sceneBox, 0x0000ff);
    // scene.add(boxHelper);
    // Name to identify rhino object node
    object.name = 'rhinoDoc1';
					object.children.map(child => {
      // Access attributes from the Rhino document
			let col = child.userData.attributes.drawColor;
			// console.log(child.userData.attributes.drawColor)
      let color = new THREE.Color(col.r/255, col.g/255, col.b/255);
      let mat = new THREE.MeshLambertMaterial( {
        color: color,
      } );
        // Set mesh material
				child.material = mat;
				child.layers.set(2)
				// scene.add(child)
		});

			object.traverse( function( obj) {
					obj.layers.set(2);
			} );
					object.layers.set(2);
					scene.add( object );
					// initGUI( object.userData.layers );
				} );

				loader.load( 'models/3dm/RhinoTemplate8.3dm', function ( object ) {
					// sceneBox.setFromObject(object);
    // let boxHelper = new THREE.Box3Helper(sceneBox, 0x0000ff);
    // scene.add(boxHelper);
    // Name to identify rhino object node
    object.name = 'rhinoDoc1';
					object.children.map(child => {
      // Access attributes from the Rhino document
			let col = child.userData.attributes.drawColor;
			// console.log(child.userData.attributes.drawColor)
      let color = new THREE.Color(col.r/255, col.g/255, col.b/255);
      let mat = new THREE.MeshLambertMaterial( {
        color: color,
      } );
        // Set mesh material
				child.material = mat;
				child.layers.set(3)
				// scene.add(child)
		});

			object.traverse( function( obj) {
					obj.layers.set(3);
			} );
					object.layers.set(3);
					scene.add( object );
					// initGUI( object.userData.layers );
				} );

		

				// camera.layers.disable(2);

				// const width = window.innerWidth;
				// const height = window.innerHeight;

				// renderer = new THREE.WebGLRenderer( { antialias: true } );
				renderer = new THREE.WebGLRenderer( { canvas: container, antialias: true } );
				renderer.setPixelRatio( window.devicePixelRatio );
				renderer.setSize( container.clientWidth,  container.clientHeight );
				// container.appendChild( renderer.domElement );

				controls = new OrbitControls( camera, container );

				window.addEventListener( 'resize', resize, false );

				

			}

			

			

			function resize() {

				// const width = window.innerWidth;
				// const height = window.innerHeight;
				const width = container.clientWidth*.5;
				const heigth = container.clientHeigth

				camera.aspect = width / height;
				camera.updateProjectionMatrix();

				renderer.setSize( width, height );

			}

			function animate() {

				controls.update();
				renderer.render( scene, camera );
				// console.log(camera.position)

				requestAnimationFrame( animate );

	// 			if(prev != next){
	// 	prev++;
	// 	console.log(prev)
	// 	updateData();
	// }

			}

			function initGUI( layers ) {

				gui = new GUI( { width: 300 } );
				const layersControl = gui.addFolder( 'layers' );
				// layersControl.open();
				gui.hide();

				

				for ( let i = 0; i < layers.length; i ++ ) {
					// console.log(layers[i])
					// console.log( "rgb(" + layers[i].color.r + ", " + layers[i].color.g + ", " + layers[i].color.b +")")
					// allLayers.push(layers[i].name)

					

					const layer = layers[ i ];

					let eachLayerArea = 0;

					scene.traverse( function ( child ) {

					if ( child.userData.hasOwnProperty( 'attributes' ) ) {

						if ( 'layerIndex' in child.userData.attributes ) {

							const layerName = layers[ child.userData.attributes.layerIndex ].name;
							// console.log(layerName)

							if ( layerName === layer.name ) {
								// console.log(layerName)

								//CREATE ARRAY OF VECTOR3
								let vector3Array = []
										for(let i = 0; i < child.children[0].geometry.attributes.position.array.length/3; i++){
											let myVectorArray = []
											for(let j = 0; j<3; j++){
												myVectorArray.push(child.children[0].geometry.attributes.position.array[i*3 + j])
											}
											var a = new THREE.Vector3( myVectorArray[0], myVectorArray[1], myVectorArray[2] );
											vector3Array.push(a)
										}

				
										//CREATE FACE ARRAY
										// console.log((child.children[0].geometry.index.array.length)/3)

										for(let i = 0; i < child.children[0].geometry.index.array.length/3; i++){

											let myFaceArray = []
											for(let j = 0; j<3; j++){
												myFaceArray.push(child.children[0].geometry.index.array[i*3 + j])
												
											}
											var t = new THREE.Triangle(vector3Array[myFaceArray[0]],vector3Array[myFaceArray[1]],vector3Array[myFaceArray[2]]);
											var area = t.getArea();
											// console.log("hi")
											// console.log(area)
											eachLayerArea += area;

										}
							}
						}
					}
					
				});
				allLayerAreas.push(eachLayerArea);

				var rgbToHex = function (rgb) { 
					var hex = Number(rgb). toString(16); 
					if (hex. length < 2) { 
						hex = "0" + hex; 
					} return hex; 
				};

				let myCol = rgbToHex(layers[i].color.r)
				myCol += rgbToHex(layers[i].color.g)
				myCol += rgbToHex(layers[i].color.b)

				allColors.push("#"+myCol);

				allLayers.push({
						variantId: layers[i].name,
						variantColor: "rgb(" + layers[i].color.r + ", " + layers[i].color.g + ", " + layers[i].color.b +")",
						variantArea: eachLayerArea.toFixed(2), 
						variantGWP: (eachLayerArea * 18.285).toFixed(2)
					})






					layersControl.add( layer, 'visible' ).name( layer.name ).onChange( function ( val ) {
						// console.log("does this run?")

						const name = this.object.name;

						scene.traverse( function ( child ) {

							if ( child.userData.hasOwnProperty( 'attributes' ) ) {

								if ( 'layerIndex' in child.userData.attributes ) {

									const layerName = layers[ child.userData.attributes.layerIndex ].name;

									if ( layerName === name ) {

										child.visible = val;
										// console.log(child.children[0].geometry.attributes.position.array)
										// console.log(child.children[0].geometry.index.array)
										// console.log(child)

										
										layer.visible = val;

									}

								}

							}

						} );

					} );

					

				}

				console.log(allLayers)
				console.log(allLayerAreas)
				console.log(allColors)
			}



			var app = new Vue({
  el: '#app',
  data: {
    product: 'Socks',
    image: 'https://www.vuemastery.com/images/challenges/vmSocks-green-onWhite.jpg',
    inStock: true,
    details: ['80% cotton', '20% polyester', 'Gender-neutral'],
    variants: allLayers,
		// variants: [
    //   {
    //     variantId: 2234,
    //     variantColor: 'green'    
    //   },
    //   {
    //     variantId: 2235,
    //     variantColor: 'blue'
    //   }
    // ],
		// sizes: ['S', 'M', 'L', 'XL', 'XXL', 'XXXL']
		sizes: allLayers
  },computed: {
        sum() {
					let tot = 0;
					for(let i = 0; i < this.variants.length; i++){
						tot += parseInt(this.variants[i].variantGWP)
					}
            return tot 
        }
}})

document.getElementById("myBtn").addEventListener("click", function() {
		console.log("Hello World");

					camera.layers.enable(1);
					camera.layers.disable(2);
					camera.layers.disable(3);
					console.log("clicked")
				});

				document.getElementById("myBtn2").addEventListener("click", function() {
		console.log("Hello World");

					camera.layers.disable(1);
					camera.layers.enable(2);
					camera.layers.disable(3);
					console.log("clicked")
				});

				document.getElementById("myBtn3").addEventListener("click", function() {
		console.log("Hello World");

					camera.layers.disable(1);
					camera.layers.disable(2);
					camera.layers.enable(3);
					console.log("clicked")
				});
	








	// var data = [13, 21, 34, 55, 89,2];
	data = allLayers

	// set the color scale

	var alphabet = "abdef".split("");

    var margin = {top: 10, bottom: 10, left: 10, right: 10},
      width = window.innerWidth - margin.left - margin.right,
      height = window.innerHeight - margin.top - margin.bottom,
      radius = 300/ 2;

    var svg = d3.select("span").append("svg")
        .attr("width", 300)
        .attr("height", 300)
      .append("g")
        .attr("transform", "translate(" + ((300 / 2) ) + "," + ((300 / 2) ) + ")");
console.log(allColors)

		// var color = d3.scaleOrdinal(["#b3b3b3", "#001488", "#4169e1", "#c7e9b7", "#85e2bd"])
// 		var color = d3.scaleOrdinal()
// 		// var color = d3.scaleBand()
// .domain(allLayers)
// .range([allColors])
		
		// var color = d3.scaleOrdinal(allColors)

    var pie = d3.pie()
        .sort(null)
        .value(function(d) { return d.value; });

    var arc = d3.arc()
        .outerRadius(radius)
        .innerRadius(radius-80);

    redraw(randomData(allLayers));

    d3.interval(function(){
			data = allLayers
      redraw(randomData(allLayers));  
    }, 2000)

    function redraw(data){

      // join
      var arcs = svg.selectAll(".arc")
          .data(pie(data), function(d){ return d.data.name; });

      // update
      arcs 
        .transition()
          .duration(1500)
          .attrTween("d", arcTween);

      // enter
      arcs.enter().append("path")
        .attr("class", "arc")
        .attr("fill", function(d) { return d.data.color; })
        .attr("d", arc)
        .each(function(d) { this._current = d; });

    }

    // Store the displayed angles in _current.
    // Then, interpolate from _current to the new angles.
    // During the transition, _current is updated in-place by d3.interpolate.
    function arcTween(a) {
      // console.log(this._current);
      var i = d3.interpolate(this._current, a);
      this._current = i(0);
      return function(t) {
        return arc(i(t));
      };
    }

    function randomData(data){
      return data.map(function(d){
        return {
          name: d.variantId,
					value: d.variantGWP,
					color: d.variantColor
        }
      });
		}
		
		// function getData(){
		// 	console.log(data)
		// }


// let mSpan = d3.select("span")
// let mSpanW = 500;
	
// 	var width = 280,
// 			height = 280;
	
// 	var outerRadius = height / 2 - 20,
// 			innerRadius = outerRadius / 3,
// 			cornerRadius = 10;
	
// 	var pie = d3.layout.pie()
// 			.padAngle(.01);
	
// 	var arc = d3.svg.arc()
// 			.padRadius(outerRadius)
// 			.innerRadius(innerRadius);
	
// 	var svg = d3.select("span").append("svg")
// 			.attr("width", 300)
// 			.attr("height", 300)
// 		.append("g")
// 			.attr("transform", "translate(" + width / 2 + "," + height / 2 + ")");

// 			function updateData() {

// 				var color1 = d3.scale.ordinal()
// .domain(data)
// .range(allColors)

// // d3.select("span").remove("svg")

// 				console.log(data)

// 			svg.selectAll("path")
// 				.data(pie(data))
// 				.enter().append("path")
// 				.each(function(d) { d.outerRadius = outerRadius - 10; })
// 				.attr("d", arc)
// 				.attr('fill', function(d){ return(color1(d.data)) })
// 				.exit().remove();
// 				// .on("mouseover", arcTween(outerRadius, 0))
// 				// .on("mouseout", arcTween(outerRadius - 10, 150));

// 				// svg.exit().remove()
// 			}
	
// 	function arcTween(outerRadius, delay) {
// 		return function() {
// 			d3.select(this).transition().delay(delay).attrTween("d", function(d) {
// 				var i = d3.interpolate(d.outerRadius, outerRadius);
// 				return function(t) { d.outerRadius = i(t); return arc(d); };
// 			});
// 		};
// 	}

	


	// setTimeout(() => {  
	// 		getData();
	// 		updateData(); 
			
	// 		 }, 2000);




	
	</script>

<script>

				document.getElementById("btn2").addEventListener("click", function() {
					camera.layers.disable(1);
					camera.layers.enable(2);
					camera.layers.disable(3);
				});
	
				document.getElementById("btn3").addEventListener("click", function() {
					camera.layers.disable(1);
					camera.layers.disable(2);
					camera.layers.enable(3);
				});
	</script>



		<script>
			function readImage(file) {
  // Check if the file is an image.
  if (file.type && file.type.indexOf('image') === -1) {
    console.log('File is not an image.', file.type, file);
    return;
  }

  const reader = new FileReader();
  reader.addEventListener('load', (event) => {
    img.src = event.target.result;
  });
  reader.readAsDataURL(file);
}
		</script>



	</body>
</html>
